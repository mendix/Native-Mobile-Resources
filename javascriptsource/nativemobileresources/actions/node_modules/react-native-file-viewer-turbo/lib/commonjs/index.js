"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.open = open;
var _reactNative = require("react-native");
var _react = require("react");
// @ts-expect-error
const isTurboModuleEnabled = global.__turboModuleProxy != null;
const FileViewerTurbo = isTurboModuleEnabled ? require('./NativeFileViewerTurbo').default : _reactNative.NativeModules.FileViewerTurbo;
const eventEmitter = new _reactNative.NativeEventEmitter(FileViewerTurbo);
const dismissListener = /*#__PURE__*/(0, _react.createRef)();
async function open(path, options = {}) {
  const {
    onDismiss,
    ...nativeOptions
  } = options;
  try {
    dismissListener.current = eventEmitter.addListener('onViewerDidDismiss', () => {
      onDismiss?.();
      dismissListener.current?.remove();
    });
    await FileViewerTurbo.open(normalize(path), nativeOptions);
  } catch (error) {
    throw error;
  }
}
function normalize(path) {
  const filePrefix = 'file://';
  if (path.startsWith(filePrefix)) {
    path = path.substring(filePrefix.length);
    try {
      path = decodeURI(path);
    } catch (e) {}
  }
  return path;
}
//# sourceMappingURL=index.js.map