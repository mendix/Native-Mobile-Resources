{"version":3,"names":["TIRAMISU_VERSION_CODE","NativeModule","NativeModules","RNPermissions","openSettings","check","permission","checkPermission","request","rationale","shouldShowRationale","shouldShowRequestPermissionRationale","title","message","buttonPositive","buttonNegative","buttonNeutral","Promise","resolve","buttons","onPress","push","text","requestPermission","Alert","alert","cancelable","checkNotifications","platformVersion","status","settings","requestNotifications","checkMultiple","permissions","dedup","uniq","checkMultiplePermissions","requestMultiple","requestMultiplePermissions","methods","checkLocationAccuracy","openLimitedPhotoLibraryPicker","requestLocationAccuracy"],"sources":["methods.android.ts"],"sourcesContent":["import {Alert, AlertButton, NativeModules} from 'react-native';\nimport type {Contract} from './contract';\nimport type {NotificationsResponse, Permission, PermissionStatus, Rationale} from './types';\nimport {\n  checkLocationAccuracy,\n  openLimitedPhotoLibraryPicker,\n  requestLocationAccuracy,\n} from './unsupportedPlatformMethods';\nimport {platformVersion, uniq} from './utils';\n\nconst TIRAMISU_VERSION_CODE = 33;\n\nconst NativeModule: {\n  checkPermission: (permission: Permission) => Promise<PermissionStatus>;\n  requestPermission: (permission: Permission) => Promise<PermissionStatus>;\n  checkNotifications: () => Promise<NotificationsResponse>;\n  openSettings: () => Promise<true>;\n  shouldShowRequestPermissionRationale: (permission: Permission) => Promise<boolean>;\n\n  checkMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n  requestMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n} = NativeModules.RNPermissions;\n\nasync function openSettings(): Promise<void> {\n  await NativeModule.openSettings();\n}\n\nfunction check(permission: Permission): Promise<PermissionStatus> {\n  return NativeModule.checkPermission(permission);\n}\n\nasync function request(permission: Permission, rationale?: Rationale): Promise<PermissionStatus> {\n  if (rationale) {\n    const shouldShowRationale = await NativeModule.shouldShowRequestPermissionRationale(permission);\n\n    if (shouldShowRationale) {\n      const {title, message, buttonPositive, buttonNegative, buttonNeutral} = rationale;\n\n      return new Promise((resolve) => {\n        const buttons: AlertButton[] = [];\n\n        if (buttonNegative) {\n          const onPress = () => resolve(NativeModule.checkPermission(permission));\n          buttonNeutral && buttons.push({text: buttonNeutral, onPress});\n          buttons.push({text: buttonNegative, onPress});\n        }\n\n        buttons.push({\n          text: buttonPositive,\n          onPress: () => resolve(NativeModule.requestPermission(permission)),\n        });\n\n        Alert.alert(title, message, buttons, {cancelable: false});\n      });\n    }\n  }\n\n  return NativeModule.requestPermission(permission);\n}\n\nasync function checkNotifications(): Promise<NotificationsResponse> {\n  if (platformVersion < TIRAMISU_VERSION_CODE) {\n    return NativeModule.checkNotifications();\n  }\n\n  const status = await check('android.permission.POST_NOTIFICATIONS');\n  return {status, settings: {}};\n}\n\nasync function requestNotifications(): Promise<NotificationsResponse> {\n  if (platformVersion < TIRAMISU_VERSION_CODE) {\n    return NativeModule.checkNotifications();\n  }\n\n  const status = await request('android.permission.POST_NOTIFICATIONS');\n  return {status, settings: {}};\n}\n\nfunction checkMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.checkMultiplePermissions(dedup);\n}\n\nfunction requestMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.requestMultiplePermissions(dedup);\n}\n\nexport const methods: Contract = {\n  check,\n  checkLocationAccuracy,\n  checkMultiple,\n  checkNotifications,\n  openLimitedPhotoLibraryPicker,\n  openSettings,\n  request,\n  requestLocationAccuracy,\n  requestMultiple,\n  requestNotifications,\n};\n"],"mappings":"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"}