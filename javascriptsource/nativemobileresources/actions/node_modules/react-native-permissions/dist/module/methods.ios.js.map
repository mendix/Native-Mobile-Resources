{"version":3,"names":["NativeModules","RESULTS","uniq","NativeModule","RNPermissions","openLimitedPhotoLibraryPicker","openSettings","check","permission","available","includes","UNAVAILABLE","request","checkLocationAccuracy","requestLocationAccuracy","options","purposeKey","checkNotifications","requestNotifications","checkMultiple","permissions","output","dedup","Promise","all","map","requestMultiple","index","length","methods"],"sources":["methods.ios.ts"],"sourcesContent":["import {NativeModules} from 'react-native';\nimport type {Contract} from './contract';\nimport {RESULTS} from './results';\nimport type {\n  LocationAccuracy,\n  LocationAccuracyOptions,\n  NotificationOption,\n  NotificationsResponse,\n  Permission,\n  PermissionStatus,\n} from './types';\nimport {uniq} from './utils';\n\nconst NativeModule: {\n  available: Permission[];\n\n  check: (permission: Permission) => Promise<PermissionStatus>;\n  checkLocationAccuracy: () => Promise<LocationAccuracy>;\n  checkNotifications: () => Promise<NotificationsResponse>;\n  openLimitedPhotoLibraryPicker: () => Promise<true>;\n  openSettings: () => Promise<true>;\n  request: (permission: Permission, options?: object) => Promise<PermissionStatus>;\n  requestLocationAccuracy: (purposeKey: string) => Promise<LocationAccuracy>;\n  requestNotifications: (options: NotificationOption[]) => Promise<NotificationsResponse>;\n} = NativeModules.RNPermissions;\n\nasync function openLimitedPhotoLibraryPicker(): Promise<void> {\n  await NativeModule.openLimitedPhotoLibraryPicker();\n}\n\nasync function openSettings(): Promise<void> {\n  await NativeModule.openSettings();\n}\n\nasync function check(permission: Permission): Promise<PermissionStatus> {\n  return NativeModule.available.includes(permission)\n    ? NativeModule.check(permission)\n    : RESULTS.UNAVAILABLE;\n}\n\nasync function request(permission: Permission): Promise<PermissionStatus> {\n  return NativeModule.available.includes(permission)\n    ? NativeModule.request(permission)\n    : RESULTS.UNAVAILABLE;\n}\n\nfunction checkLocationAccuracy(): Promise<LocationAccuracy> {\n  return NativeModule.checkLocationAccuracy();\n}\n\nfunction requestLocationAccuracy(options: LocationAccuracyOptions): Promise<LocationAccuracy> {\n  return NativeModule.requestLocationAccuracy(options.purposeKey);\n}\n\nexport function checkNotifications(): Promise<NotificationsResponse> {\n  return NativeModule.checkNotifications();\n}\n\nexport function requestNotifications(\n  options: NotificationOption[],\n): Promise<NotificationsResponse> {\n  return NativeModule.requestNotifications(options);\n}\n\nasync function checkMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  type Output = Record<P[number], PermissionStatus>;\n\n  const output: Partial<Output> = {};\n  const dedup = uniq(permissions);\n\n  await Promise.all(\n    dedup.map(async (permission: P[number]) => {\n      output[permission] = await check(permission);\n    }),\n  );\n\n  return output as Output;\n}\n\nasync function requestMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  type Output = Record<P[number], PermissionStatus>;\n\n  const output: Partial<Output> = {};\n  const dedup = uniq(permissions);\n\n  for (let index = 0; index < dedup.length; index++) {\n    const permission: P[number] = dedup[index];\n    output[permission] = await request(permission);\n  }\n\n  return output as Output;\n}\n\nexport const methods: Contract = {\n  check,\n  checkLocationAccuracy,\n  checkMultiple,\n  checkNotifications,\n  openLimitedPhotoLibraryPicker,\n  openSettings,\n  request,\n  requestLocationAccuracy,\n  requestMultiple,\n  requestNotifications,\n};\n"],"mappings":"AAAA,SAAQA,aAAR,QAA4B,cAA5B;AAEA,SAAQC,OAAR,QAAsB,WAAtB;AASA,SAAQC,IAAR,QAAmB,SAAnB;AAEA,MAAMC,YAWL,GAAGH,aAAa,CAACI,aAXlB;;AAaA,eAAeC,6BAAf,GAA8D;EAC5D,MAAMF,YAAY,CAACE,6BAAb,EAAN;AACD;;AAED,eAAeC,YAAf,GAA6C;EAC3C,MAAMH,YAAY,CAACG,YAAb,EAAN;AACD;;AAED,eAAeC,KAAf,CAAqBC,UAArB,EAAwE;EACtE,OAAOL,YAAY,CAACM,SAAb,CAAuBC,QAAvB,CAAgCF,UAAhC,IACHL,YAAY,CAACI,KAAb,CAAmBC,UAAnB,CADG,GAEHP,OAAO,CAACU,WAFZ;AAGD;;AAED,eAAeC,OAAf,CAAuBJ,UAAvB,EAA0E;EACxE,OAAOL,YAAY,CAACM,SAAb,CAAuBC,QAAvB,CAAgCF,UAAhC,IACHL,YAAY,CAACS,OAAb,CAAqBJ,UAArB,CADG,GAEHP,OAAO,CAACU,WAFZ;AAGD;;AAED,SAASE,qBAAT,GAA4D;EAC1D,OAAOV,YAAY,CAACU,qBAAb,EAAP;AACD;;AAED,SAASC,uBAAT,CAAiCC,OAAjC,EAA8F;EAC5F,OAAOZ,YAAY,CAACW,uBAAb,CAAqCC,OAAO,CAACC,UAA7C,CAAP;AACD;;AAED,OAAO,SAASC,kBAAT,GAA8D;EACnE,OAAOd,YAAY,CAACc,kBAAb,EAAP;AACD;AAED,OAAO,SAASC,oBAAT,CACLH,OADK,EAE2B;EAChC,OAAOZ,YAAY,CAACe,oBAAb,CAAkCH,OAAlC,CAAP;AACD;;AAED,eAAeI,aAAf,CACEC,WADF,EAEgD;EAG9C,MAAMC,MAAuB,GAAG,EAAhC;EACA,MAAMC,KAAK,GAAGpB,IAAI,CAACkB,WAAD,CAAlB;EAEA,MAAMG,OAAO,CAACC,GAAR,CACJF,KAAK,CAACG,GAAN,CAAU,MAAOjB,UAAP,IAAiC;IACzCa,MAAM,CAACb,UAAD,CAAN,GAAqB,MAAMD,KAAK,CAACC,UAAD,CAAhC;EACD,CAFD,CADI,CAAN;EAMA,OAAOa,MAAP;AACD;;AAED,eAAeK,eAAf,CACEN,WADF,EAEgD;EAG9C,MAAMC,MAAuB,GAAG,EAAhC;EACA,MAAMC,KAAK,GAAGpB,IAAI,CAACkB,WAAD,CAAlB;;EAEA,KAAK,IAAIO,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGL,KAAK,CAACM,MAAlC,EAA0CD,KAAK,EAA/C,EAAmD;IACjD,MAAMnB,UAAqB,GAAGc,KAAK,CAACK,KAAD,CAAnC;IACAN,MAAM,CAACb,UAAD,CAAN,GAAqB,MAAMI,OAAO,CAACJ,UAAD,CAAlC;EACD;;EAED,OAAOa,MAAP;AACD;;AAED,OAAO,MAAMQ,OAAiB,GAAG;EAC/BtB,KAD+B;EAE/BM,qBAF+B;EAG/BM,aAH+B;EAI/BF,kBAJ+B;EAK/BZ,6BAL+B;EAM/BC,YAN+B;EAO/BM,OAP+B;EAQ/BE,uBAR+B;EAS/BY,eAT+B;EAU/BR;AAV+B,CAA1B"}