{"version":3,"names":["Alert","NativeModules","checkLocationAccuracy","openLimitedPhotoLibraryPicker","requestLocationAccuracy","platformVersion","uniq","TIRAMISU_VERSION_CODE","NativeModule","RNPermissions","openSettings","check","permission","checkPermission","request","rationale","shouldShowRationale","shouldShowRequestPermissionRationale","title","message","buttonPositive","buttonNegative","buttonNeutral","Promise","resolve","buttons","onPress","push","text","requestPermission","alert","cancelable","checkNotifications","status","settings","requestNotifications","checkMultiple","permissions","dedup","checkMultiplePermissions","requestMultiple","requestMultiplePermissions","methods"],"sources":["methods.android.ts"],"sourcesContent":["import {Alert, AlertButton, NativeModules} from 'react-native';\nimport type {Contract} from './contract';\nimport type {NotificationsResponse, Permission, PermissionStatus, Rationale} from './types';\nimport {\n  checkLocationAccuracy,\n  openLimitedPhotoLibraryPicker,\n  requestLocationAccuracy,\n} from './unsupportedPlatformMethods';\nimport {platformVersion, uniq} from './utils';\n\nconst TIRAMISU_VERSION_CODE = 33;\n\nconst NativeModule: {\n  checkPermission: (permission: Permission) => Promise<PermissionStatus>;\n  requestPermission: (permission: Permission) => Promise<PermissionStatus>;\n  checkNotifications: () => Promise<NotificationsResponse>;\n  openSettings: () => Promise<true>;\n  shouldShowRequestPermissionRationale: (permission: Permission) => Promise<boolean>;\n\n  checkMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n  requestMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n} = NativeModules.RNPermissions;\n\nasync function openSettings(): Promise<void> {\n  await NativeModule.openSettings();\n}\n\nfunction check(permission: Permission): Promise<PermissionStatus> {\n  return NativeModule.checkPermission(permission);\n}\n\nasync function request(permission: Permission, rationale?: Rationale): Promise<PermissionStatus> {\n  if (rationale) {\n    const shouldShowRationale = await NativeModule.shouldShowRequestPermissionRationale(permission);\n\n    if (shouldShowRationale) {\n      const {title, message, buttonPositive, buttonNegative, buttonNeutral} = rationale;\n\n      return new Promise((resolve) => {\n        const buttons: AlertButton[] = [];\n\n        if (buttonNegative) {\n          const onPress = () => resolve(NativeModule.checkPermission(permission));\n          buttonNeutral && buttons.push({text: buttonNeutral, onPress});\n          buttons.push({text: buttonNegative, onPress});\n        }\n\n        buttons.push({\n          text: buttonPositive,\n          onPress: () => resolve(NativeModule.requestPermission(permission)),\n        });\n\n        Alert.alert(title, message, buttons, {cancelable: false});\n      });\n    }\n  }\n\n  return NativeModule.requestPermission(permission);\n}\n\nasync function checkNotifications(): Promise<NotificationsResponse> {\n  if (platformVersion < TIRAMISU_VERSION_CODE) {\n    return NativeModule.checkNotifications();\n  }\n\n  const status = await check('android.permission.POST_NOTIFICATIONS');\n  return {status, settings: {}};\n}\n\nasync function requestNotifications(): Promise<NotificationsResponse> {\n  if (platformVersion < TIRAMISU_VERSION_CODE) {\n    return NativeModule.checkNotifications();\n  }\n\n  const status = await request('android.permission.POST_NOTIFICATIONS');\n  return {status, settings: {}};\n}\n\nfunction checkMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.checkMultiplePermissions(dedup);\n}\n\nfunction requestMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.requestMultiplePermissions(dedup);\n}\n\nexport const methods: Contract = {\n  check,\n  checkLocationAccuracy,\n  checkMultiple,\n  checkNotifications,\n  openLimitedPhotoLibraryPicker,\n  openSettings,\n  request,\n  requestLocationAccuracy,\n  requestMultiple,\n  requestNotifications,\n};\n"],"mappings":"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"}